function A_p = eval_A_p(q_p)

[m1, m2, m3, l1, l2, l3, g] = set_parameters();
m=m1;
q1_p=q_p(1);
q2_p=q_p(2);
q3_p=q_p(3);
t2 = q1_p-q2_p;
t3 = cos(t2);
t4 = q1_p-q3_p;
t5 = cos(t4);
t6 = l1.*l3.*t5.*2.0;
t7 = l2.^2;
t8 = l3.^2;
A_p = reshape([m.*(t6+l1.^2.*9.0-l1.*l2.*t3.*2.0).*(-1.0./4.0),l1.*l2.*m.*t3.*(1.0./2.0),l1.*l3.*m.*t5.*(-1.0./2.0),m.*(t7-l1.*l2.*t3.*2.0).*(-1.0./4.0),m.*t7.*(-1.0./4.0),0.0,m.*(t6+t8).*(-1.0./4.0),0.0,m.*t8.*(-1.0./4.0)],[3,3]);
end